<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturas de Venta - Pollera Na'Guara</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="facturas.css">
</head>
<body class="min-h-full bg-gray-50">
    <main class="container mx-auto p-6 max-w-7xl">
        <!-- Breadcrumb -->
        <div class="breadcrumb">
            <a href="../index.html">Dashboard</a> / 
            <a href="Ventas.html">Ventas</a> / 
            <span>Facturas de Venta</span>
        </div>

        <!-- Header -->
        <div class="page-header">
            <h1>Facturas de Venta</h1>
            <p>Gestión y consulta de todas las facturas generadas</p>
        </div>

        <!-- Filtros -->
        <div class="card mb-4">
            <div class="card-header">
                <h3><i class="fas fa-filter"></i> Filtros de Búsqueda</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <label for="fechaInicio" class="block text-sm font-medium text-gray-700 mb-2">Fecha Inicio</label>
                        <input type="date" id="fechaInicio" class="input-field">
                    </div>
                    <div class="col-md-3">
                        <label for="fechaFin" class="block text-sm font-medium text-gray-700 mb-2">Fecha Fin</label>
                        <input type="date" id="fechaFin" class="input-field">
                    </div>
                    <div class="col-md-3">
                        <label for="clienteFilter" class="block text-sm font-medium text-gray-700 mb-2">Cliente</label>
                        <input type="text" id="clienteFilter" class="input-field" placeholder="Nombre o Cédula">
                    </div>
                    <div class="col-md-3">
                        <label for="metodoPagoFilter" class="block text-sm font-medium text-gray-700 mb-2">Método Pago</label>
                        <select id="metodoPagoFilter" class="input-field">
                            <option value="">Todos</option>
                            <option value="efectivo">Efectivo BS</option>
                            <option value="efectivo_usd">Efectivo USD</option>
                            <option value="tarjeta">Tarjeta</option>
                            <option value="transferencia">Transferencia</option>
                            <option value="pago_movil">Pago Móvil</option>
                            <option value="punto_venta">Punto de Venta</option>
                            <option value="mixto">Mixto</option>
                        </select>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-3">
                        <label for="estadoFilter" class="block text-sm font-medium text-gray-700 mb-2">Estado</label>
                        <select id="estadoFilter" class="input-field">
                    <option value="">Todas</option>  <!-- Cambiado a vacío para mostrar todas -->
                     <option value="completada">Completadas</option>
                     <option value="anulada">Anuladas</option>
                      </select>
                    </div>
                    <div class="col-md-9 text-right" style="align-self: end;">
                        <button class="btn-primary" id="btnBuscar">
                            <i class="fas fa-search"></i> Buscar
                        </button>
                        <button class="btn-success" id="btnExportar">
                            <i class="fas fa-file-export"></i> Exportar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Estadísticas -->
        <div class="row mb-4" id="estadisticasContainer">
            <!-- Las estadísticas se cargarán aquí -->
        </div>

        <!-- Lista de Facturas -->
        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-receipt"></i> Lista de Facturas</h3>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table" id="tablaFacturas">
                        <thead>
                            <tr>
                                <th># Factura</th>
                                <th>Fecha</th>
                                <th>Cliente</th>
                                <th>Vendedor</th>
                                <th>Método Pago</th>
                                <th>Total</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="facturasBody">
                            <!-- Las facturas se cargarán aquí -->
                        </tbody>
                    </table>
                </div>

                <!-- Paginación -->
                <div class="pagination" id="paginacion">
                    <!-- La paginación se cargará aquí -->
                </div>
            </div>
        </div>
    </main>

    <!-- Modal Detalles Factura -->
    <div id="modalDetalles" class="modal hidden">
    <div class="modal-content" style="max-width: 800px; max-height: 90vh;">
        <div class="modal-header">
            <h3>Detalles de Factura</h3>
            <button class="close-btn" id="closeDetalles">&times;</button>
        </div>
        <div class="modal-body" id="detallesFacturaBody" style="padding: 20px;">
            <!-- Los detalles se cargarán aquí -->
        </div>
    </div>
</div>

    <!-- Modal Anular Factura -->
    <div id="modalAnular" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Anular Factura</h3>
                <button class="close-btn" id="closeAnular">&times;</button>
            </div>
            <div class="modal-body">
                <p>¿Está seguro que desea anular esta factura?</p>
                <p><strong>Nota:</strong> Esta acción revertirá el stock de productos y no se puede deshacer.</p>
                <div class="form-group">
                    <label for="motivoAnulacion">Motivo de anulación:</label>
                    <textarea id="motivoAnulacion" class="input-field" rows="3" placeholder="Ingrese el motivo de la anulación..."></textarea>
                </div>
                <div class="modal-actions">
                    <button class="btn-primary" id="cancelarAnulacion">Cancelar</button>
                    <button class="btn-danger" id="confirmarAnulacion">Anular Factura</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="facturas-ventas.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</body>
</html>